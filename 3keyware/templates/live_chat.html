{% extends "base.html" %}

{% block title %}Live Chat - 3keyware{% endblock %}

{% block content %}
<!-- Live Chat Interface -->
<section class="live-chat-section py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="chat-container">
                    <div class="chat-header">
                        <h4><i class="fas fa-comments me-2"></i>Canlı Sohbet</h4>
                        <span class="online-status">
                            <i class="fas fa-circle text-success"></i> Online
                        </span>
                    </div>

                    <div class="chat-messages" id="chatMessages">
                        <div class="message bot-message">
                            <div class="message-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-content">
                                <p>Merhaba! 3Keyware'a hoşgeldin. Size nasıl yardımcı olabilrim ?</p>
                                <small class="message-time">Just now</small>
                            </div>
                        </div>
                    </div>

                    <div class="chat-input-container">
                        <div class="input-group">
                            <input type="text" class="form-control" id="chatInput" placeholder="Type your message...">
                            <button class="btn btn-primary" id="sendButton">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>

                    <div class="quick-actions mt-3">
                        <h6>Kısa Sorular:</h6>
                        <div class="quick-action-buttons">
                            <button class="btn btn-outline-primary btn-sm quick-btn" data-message="What services do you offer?">
                                Services
                            </button>
                            <button class="btn btn-outline-primary btn-sm quick-btn" data-message="How much does a website cost?">
                                Pricing
                            </button>
                            <button class="btn btn-outline-primary btn-sm quick-btn" data-message="How long does development take?">
                                Timeline
                            </button>
                            <button class="btn btn-outline-primary btn-sm quick-btn" data-message="Can I see your portfolio?">
                                Portfolio
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const chatMessages = document.getElementById('chatMessages');
    const chatInput = document.getElementById('chatInput');
    const sendButton = document.getElementById('sendButton');
    const quickButtons = document.querySelectorAll('.quick-btn');

    const botResponses = {
        'services': 'We offer web development, mobile app development, and game development services. You can learn more on our Services page.',
        'pricing': 'Our pricing starts from $2,999 for basic websites. For detailed pricing, check our Pricing page or request a custom quote.',
        'timeline': 'Project timelines vary from 2-4 weeks for simple websites to 8-16 weeks for complex applications.',
        'portfolio': 'You can view our featured projects and case studies on our Portfolio page. We\'ve completed 50+ successful projects.',
        'default': 'Thanks for your question! For detailed information, please contact us directly or browse our website. Our team will get back to you soon.'
    };

    function addMessage(content, isBot = false) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isBot ? 'bot-message' : 'user-message'}`;

        const now = new Date();
        const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

        messageDiv.innerHTML = `
            <div class="message-avatar">
                <i class="fas fa-${isBot ? 'robot' : 'user'}"></i>
            </div>
            <div class="message-content">
                <p>${content}</p>
                <small class="message-time">${timeString}</small>
            </div>
        `;

        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function getBotResponse(message) {
        const lowerMessage = message.toLowerCase();

        if (lowerMessage.includes('service') || lowerMessage.includes('what do you do')) {
            return botResponses.services;
        } else if (lowerMessage.includes('price') || lowerMessage.includes('cost') || lowerMessage.includes('how much')) {
            return botResponses.pricing;
        } else if (lowerMessage.includes('time') || lowerMessage.includes('long') || lowerMessage.includes('timeline')) {
            return botResponses.timeline;
        } else if (lowerMessage.includes('portfolio') || lowerMessage.includes('work') || lowerMessage.includes('projects')) {
            return botResponses.portfolio;
        } else {
            return botResponses.default;
        }
    }

    function sendMessage() {
        const message = chatInput.value.trim();
        if (message) {
            addMessage(message, false);
            chatInput.value = '';

            setTimeout(() => {
                const response = getBotResponse(message);
                addMessage(response, true);
            }, 1000);
        }
    }

    sendButton.addEventListener('click', sendMessage);

    chatInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });

    quickButtons.forEach(button => {
        button.addEventListener('click', function() {
            const message = this.getAttribute('data-message');
            chatInput.value = message;
            sendMessage();
        });
    });
});
</script>
{% endblock %}